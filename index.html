<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <!-- PWA Essentials -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">
    
    <!-- Service Worker OFFLINE -->
    <link rel="manifest" href="manifest.json">
    
    <title>Mesa Ui24R Offline</title>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body, html { width: 100%; height: 100%; overflow: hidden; background: #000; }
        iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        
        .status {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            color: #4CAF50;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 12px;
            z-index: 1000;
            display: none;
        }
    </style>
</head>
<body>
    <!-- Status da conex√£o -->
    <div class="status" id="status">Conectado</div>
    
    <!-- IP LOCAL DA MESA -->
    <iframe 
        src="http://192.168.1.249" 
        id="mesaFrame"
        allow="autoplay; microphone; fullscreen"
    ></iframe>
    
    <script>
        // ========== CONFIG ==========
        const MESA_IP = "192.168.1.249";
        const MESA_URL = `http://${MESA_IP}`;
        
        // ========== DETECTAR ONLINE/OFFLINE ==========
        function updateOnlineStatus() {
            const status = document.getElementById('status');
            
            if (navigator.onLine) {
                status.textContent = "‚úÖ Online";
                status.style.color = "#4CAF50";
            } else {
                status.textContent = "üì° Rede Local";
                status.style.color = "#FF9800";
            }
            
            // Mostra por 3 segundos
            status.style.display = 'block';
            setTimeout(() => {
                status.style.display = 'none';
            }, 3000);
        }
        
        // Event listeners
        window.addEventListener('online', updateOnlineStatus);
        window.addEventListener('offline', updateOnlineStatus);
        
        // ========== CARREGAMENTO INTELIGENTE ==========
        document.addEventListener('DOMContentLoaded', () => {
            updateOnlineStatus();
            
            // Fullscreen autom√°tico
            setTimeout(() => {
                if (document.documentElement.requestFullscreen) {
                    document.documentElement.requestFullscreen();
                }
            }, 1000);
            
            // Monitorar iframe
            const iframe = document.getElementById('mesaFrame');
            
            iframe.onload = () => {
                console.log("‚úÖ Mesa carregada");
            };
            
            iframe.onerror = () => {
                // Tenta reconectar
                setTimeout(() => {
                    iframe.src = iframe.src;
                }, 3000);
            };
        });
        
        // ========== SERVICE WORKER (CACHE OFFLINE) ==========
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(() => console.log('‚úÖ Service Worker registrado'))
                .catch(err => console.log('‚ùå SW erro:', err));
        }
    </script>
</body>
</html>
